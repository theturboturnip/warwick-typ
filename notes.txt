CS257 variant with residual counting acquired from git commit 1db806e in warwick-coursework
